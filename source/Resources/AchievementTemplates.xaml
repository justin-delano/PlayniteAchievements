<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:models="clr-namespace:PlayniteAchievements.Models.Achievements"
                    xmlns:helpers="clr-namespace:PlayniteAchievements.Views.Helpers"
                    xmlns:converters="clr-namespace:PlayniteAchievements.Views.Converters">

    <!-- =======================
         CONVERTERS
         ======================= -->
    <converters:BooleanConverter x:Key="BoolToVis" Mode="ToVisibility"/>
    <converters:BooleanConverter x:Key="InverseBoolToVis" Mode="InvertedToVisibility"/>
    <converters:PercentToRarityGlowConverter x:Key="PercentToRarityGlow"/>

    <!-- =======================
         DATAGRID STYLES
         ======================= -->

    <!-- Column Header Style with Sort Arrow and Resize Grippers -->
    <Style x:Key="AchievementColumnHeaderStyle" TargetType="DataGridColumnHeader">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Padding" Value="10,6"/>
        <Setter Property="HorizontalContentAlignment" Value="Center"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="DataGridColumnHeader">
                    <Grid Background="{TemplateBinding Background}">
                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="Center"
                                          Margin="{TemplateBinding Padding}"/>
                        <Path x:Name="SortArrow"
                              HorizontalAlignment="Right"
                              Fill="{DynamicResource TextBrush}"
                              Width="8"
                              Height="6"
                              Data="M 0,0 L 4,6 L 8,0"
                              VerticalAlignment="Center"
                              Margin="0,0,10,0"
                              RenderTransformOrigin="0.5,0.5"
                              Visibility="Collapsed"/>
                        <Thumb x:Name="PART_LeftHeaderGripper"
                               Width="0"
                               Background="Transparent"
                               IsHitTestVisible="False"
                               Focusable="False"/>
                        <Thumb x:Name="PART_RightHeaderGripper"
                               HorizontalAlignment="Right"
                               Width="8"
                               Cursor="SizeWE"
                               Background="Transparent"/>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="#18FFFFFF"/>
                        </Trigger>
                        <Trigger Property="SortDirection" Value="Ascending">
                            <Setter TargetName="SortArrow" Property="Visibility" Value="Visible"/>
                            <Setter TargetName="SortArrow" Property="RenderTransform">
                                <Setter.Value>
                                    <ScaleTransform ScaleY="-1"/>
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                        <Trigger Property="SortDirection" Value="Descending">
                            <Setter TargetName="SortArrow" Property="Visibility" Value="Visible"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Column Header Style with Tooltip -->
    <Style x:Key="AchievementColumnHeaderWithMenuStyle"
           TargetType="DataGridColumnHeader"
           BasedOn="{StaticResource AchievementColumnHeaderStyle}">
        <Setter Property="ToolTip" Value="{DynamicResource LOCPlayAch_Tooltip_RightClickShowHide}"/>
    </Style>

    <!-- DataGrid Cell Style -->
    <Style x:Key="AchievementCellStyle" TargetType="DataGridCell">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="DataGridCell">
                    <Border Background="{TemplateBinding Background}"
                            Padding="{TemplateBinding Padding}">
                        <ContentPresenter VerticalAlignment="Center"/>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsMouseOver}" Value="True">
                <Setter Property="Background" Value="#30FFFFFF"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsSelected}" Value="True">
                <Setter Property="Background" Value="#40FFFFFF"/>
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <!-- DataGrid Row Style -->
    <Style x:Key="AchievementRowStyle" TargetType="DataGridRow">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderBrush" Value="{DynamicResource NormalBorderBrush}"/>
        <Setter Property="BorderThickness" Value="0,0,0,1"/>
        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="MinHeight" Value="66"/>
    </Style>

    <!-- =======================
         ACHIEVEMENT TEMPLATES
         ======================= -->

    <!-- Achievement Status Template: Checkmark (unlocked) or Padlock (locked) -->
    <DataTemplate x:Key="AchievementStatusTemplate">
        <Grid VerticalAlignment="Center" HorizontalAlignment="Center">
            <TextBlock Text="&#x2713;"
                       FontSize="16"
                       FontWeight="Bold"
                       Foreground="{DynamicResource GlyphBrush}"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center">
                <TextBlock.Style>
                    <Style TargetType="TextBlock">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Unlocked}" Value="True">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
            </TextBlock>
            <Image Source="{StaticResource BadgeLocked}"
                   Width="16" Height="16"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   Opacity="0.65">
                <Image.Style>
                    <Style TargetType="Image">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Unlocked}" Value="False">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Image.Style>
            </Image>
        </Grid>
    </DataTemplate>

    <!-- Achievement Rarity Template -->
    <DataTemplate x:Key="AchievementRarityTemplate">
        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center">
            <Image Width="16" Height="16" Margin="0,0,4,0"
                   Effect="{StaticResource BadgeShadow}"
                   VerticalAlignment="Center">
                <Image.Style>
                    <Style TargetType="Image" BasedOn="{StaticResource RarityIcon}">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding HasRarity}" Value="True">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Rarity}" Value="{x:Static models:RarityTier.UltraRare}">
                                <Setter Property="Source" Value="{StaticResource BadgePlatinumHexagon}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Rarity}" Value="{x:Static models:RarityTier.Rare}">
                                <Setter Property="Source" Value="{StaticResource BadgeGoldPentagon}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Rarity}" Value="{x:Static models:RarityTier.Uncommon}">
                                <Setter Property="Source" Value="{StaticResource BadgeSilverSquare}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Rarity}" Value="{x:Static models:RarityTier.Common}">
                                <Setter Property="Source" Value="{StaticResource BadgeBronzeTriangle}"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Image.Style>
            </Image>
            <TextBlock Text="{Binding GlobalPercentText}"
                       Style="{DynamicResource BaseTextBlockStyle}"
                       FontSize="{DynamicResource FontSizeSmall}"
                       FontWeight="SemiBold"
                       Foreground="{DynamicResource TextBrush}"
                       Opacity="0.8"/>
        </StackPanel>
    </DataTemplate>

    <!-- Achievement Trophy Template -->
    <DataTemplate x:Key="AchievementTrophyTemplate">
        <Image Width="20" Height="20"
               Effect="{StaticResource BadgeShadow}"
               VerticalAlignment="Center" HorizontalAlignment="Center">
            <Image.Style>
                <Style TargetType="Image" BasedOn="{StaticResource RarityIcon}">
                    <Setter Property="Visibility" Value="Collapsed"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding HasTrophyType}" Value="True">
                            <Setter Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding TrophyType}" Value="platinum">
                            <Setter Property="Source" Value="{StaticResource TrophyPlatinum}"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding TrophyType}" Value="gold">
                            <Setter Property="Source" Value="{StaticResource TrophyGold}"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding TrophyType}" Value="silver">
                            <Setter Property="Source" Value="{StaticResource TrophySilver}"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding TrophyType}" Value="bronze">
                            <Setter Property="Source" Value="{StaticResource TrophyBronze}"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Image.Style>
        </Image>
    </DataTemplate>

    <!-- Achievement Points Template -->
    <DataTemplate x:Key="AchievementPointsTemplate">
        <TextBlock Text="{Binding PointsText}"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   Style="{DynamicResource BaseTextBlockStyle}"
                   FontSize="{DynamicResource FontSizeSmall}"
                   FontWeight="SemiBold"
                   Foreground="{DynamicResource TextBrush}"
                   Opacity="0.8"/>
    </DataTemplate>

    <!-- Achievement Icon Template with Hidden/Locked State Styling -->
    <DataTemplate x:Key="AchievementIconTemplate">
        <Grid Width="56" Height="56" VerticalAlignment="Center" Margin="4,14,0,14" ClipToBounds="False">
            <Border CornerRadius="6" RenderOptions.BitmapScalingMode="HighQuality">
                <Border.Style>
                    <Style TargetType="Border">
                        <Setter Property="Opacity" Value="0.5"/>
                        <Setter Property="Effect" Value="{x:Null}"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Unlocked}" Value="True">
                                <Setter Property="Opacity" Value="1"/>
                                <Setter Property="Effect" Value="{Binding Percent, Converter={StaticResource PercentToRarityGlow}}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding IsIconHidden}" Value="True">
                                <Setter Property="Opacity" Value="1"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
                <Border.Background>
                    <ImageBrush Stretch="UniformToFill"
                                helpers:AsyncImage.Uri="{Binding DisplayIcon}"
                                helpers:AsyncImage.DecodePixel="64"/>
                </Border.Background>
            </Border>
        </Grid>
    </DataTemplate>

    <!-- Achievement Info Template with Hidden Styling -->
    <DataTemplate x:Key="AchievementInfoTemplate">
        <StackPanel Margin="12,10" VerticalAlignment="Center" Background="Transparent">
            <TextBlock FontWeight="SemiBold"
                       Foreground="{DynamicResource TextBrush}"
                       TextWrapping="Wrap">
                <TextBlock.Style>
                    <Style TargetType="TextBlock">
                        <Setter Property="FontSize" Value="{DynamicResource FontSize}"/>
                        <Setter Property="Opacity" Value="0.7"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Unlocked}" Value="True">
                                <Setter Property="Opacity" Value="1"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding IsTitleHidden}" Value="True">
                                <Setter Property="FontStyle" Value="Italic"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
                <Run Text="{Binding DisplayNameResolved, Mode=OneWay}"/>
                <Run Text="{Binding HiddenTitleSuffix, Mode=OneWay}"
                     FontStyle="Italic"
                     FontSize="{DynamicResource FontSizeSmall}"
                     Foreground="{DynamicResource TextBrushDarker}"/>
            </TextBlock>
            <TextBlock Text="{Binding DescriptionResolved}"
                       FontSize="{DynamicResource FontSizeSmall}"
                       Foreground="{DynamicResource TextBrush}"
                       Opacity="0.7"
                       TextWrapping="Wrap"
                       MaxHeight="44"
                       TextTrimming="CharacterEllipsis"
                       Margin="0,3,0,0">
                <TextBlock.Style>
                    <Style TargetType="TextBlock">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsDescriptionHidden}" Value="True">
                                <Setter Property="FontStyle" Value="Italic"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
            </TextBlock>
        </StackPanel>
    </DataTemplate>

    <!-- Unlock Date / Progress Template -->
    <DataTemplate x:Key="AchievementUnlockDateTemplate">
        <Grid>
            <TextBlock Text="{Binding UnlockTimeText}"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       Style="{DynamicResource BaseTextBlockStyle}"
                       Foreground="{DynamicResource TextBrush}"
                       Opacity="0.7"
                       Visibility="{Binding Unlocked, Converter={StaticResource BoolToVis}}"/>
            <Grid Visibility="{Binding Unlocked, Converter={StaticResource InverseBoolToVis}}" Margin="4,0">
                <ProgressBar Value="{Binding ProgressPercent, Mode=OneWay}"
                             Minimum="0" Maximum="100"
                             Height="18"
                             Background="{DynamicResource ControlBackgroundBrush}"
                             Foreground="{DynamicResource HighlightGlyphBrush}"
                             Visibility="{Binding HasProgress, Converter={StaticResource BoolToVis}}"/>
                <TextBlock Text="{Binding ProgressText, Mode=OneWay}"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           Style="{DynamicResource BaseTextBlockStyle}"
                           FontSize="{DynamicResource FontSizeSmall}"
                           FontWeight="SemiBold"
                           Foreground="White"
                           Visibility="{Binding HasProgress, Converter={StaticResource BoolToVis}}"/>
            </Grid>
        </Grid>
    </DataTemplate>

    <!-- =======================
         CONTROL STYLES
         ======================= -->

    <!-- Search TextBox Style -->
    <Style x:Key="SearchTextBoxStyle" TargetType="TextBox" BasedOn="{StaticResource {x:Type TextBox}}">
        <Setter Property="VerticalContentAlignment" Value="Center"/>
        <Setter Property="Padding" Value="6,4"/>
        <Setter Property="Background" Value="Transparent"/>
    </Style>

    <!-- Progress bar style -->
    <Style x:Key="GameProgressBar" TargetType="ProgressBar">
        <Setter Property="Height" Value="18"/>
        <Setter Property="Minimum" Value="0"/>
        <Setter Property="Maximum" Value="100"/>
        <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}"/>
        <Setter Property="Foreground" Value="{DynamicResource HighlightGlyphBrush}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ProgressBar">
                    <Grid>
                        <Border Background="{TemplateBinding Background}" CornerRadius="2"/>
                        <Border x:Name="PART_Track"/>
                        <Border x:Name="PART_Indicator"
                                Background="{TemplateBinding Foreground}"
                                HorizontalAlignment="Left"
                                CornerRadius="2"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Time range button style -->
    <Style x:Key="TimeRangeButtonStyle" TargetType="RadioButton">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
        <Setter Property="Padding" Value="8,4"/>
        <Setter Property="Margin" Value="0,0,4,0"/>
        <Setter Property="FontSize" Value="{DynamicResource FontSizeSmall}"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="RadioButton">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{DynamicResource NormalBorderBrush}"
                            BorderThickness="1"
                            CornerRadius="3"
                            Padding="{TemplateBinding Padding}">
                        <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsChecked" Value="True">
                            <Setter TargetName="border" Property="Background" Value="#2196F3"/>
                            <Setter Property="Foreground" Value="White"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="border" Property="Background" Value="#20FFFFFF"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Clear search button style -->
    <Style x:Key="ClearSearchButtonStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
        <Setter Property="Content" Value="âœ•"/>
        <Setter Property="Width" Value="24"/>
        <Setter Property="Margin" Value="4,0,0,0"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Visibility" Value="Collapsed"/>
        <Style.Triggers>
            <DataTrigger Binding="{Binding SearchText}" Value="">
                <Setter Property="Visibility" Value="Collapsed"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding SearchText}" Value="{x:Null}">
                <Setter Property="Visibility" Value="Collapsed"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding LeftSearchText}" Value="">
                <Setter Property="Visibility" Value="Collapsed"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding LeftSearchText}" Value="{x:Null}">
                <Setter Property="Visibility" Value="Collapsed"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding RightSearchText}" Value="">
                <Setter Property="Visibility" Value="Collapsed"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding RightSearchText}" Value="{x:Null}">
                <Setter Property="Visibility" Value="Collapsed"/>
            </DataTrigger>
        </Style.Triggers>
    </Style>

</ResourceDictionary>
