<controls:PluginUserControl x:Class="PlayniteAchievements.Views.ThemeIntegration.Legacy.PluginViewItemControl"
                   xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                   xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                   xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                   xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                   xmlns:controls="clr-namespace:Playnite.SDK.Controls;assembly=Playnite.SDK"
                   xmlns:converters="clr-namespace:PlayniteAchievements.Views.Converters"
                   mc:Ignorable="d"
                   d:DesignHeight="40" d:DesignWidth="200">
    <!--
        SuccessStory-compatible view item control.
        Matches the original SuccessStory plugin styling.
        Displays achievement summary per game in grid/list views.
        DataContext is inherited from parent (the Game for this row).
    -->
    <controls:PluginUserControl.Resources>
        <converters:BooleanConverter x:Key="BooleanToVisibilityConverter" Mode="ToVisibility" />
        <converters:BooleanConverter x:Key="InverseBoolToVisConverter" Mode="InvertedToVisibility" />
    </controls:PluginUserControl.Resources>

    <Grid Name="PART_GridContener">
        <!-- Simple label format (when IntegrationViewItemWithProgressBar=False) -->
        <TextBlock VerticalAlignment="Center"
                   Foreground="{Binding RelativeSource={RelativeSource AncestorType=controls:PluginUserControl}, Path=Foreground}"
                   FontSize="{Binding RelativeSource={RelativeSource AncestorType=controls:PluginUserControl}, Path=FontSize}"
                   Visibility="{Binding RelativeSource={RelativeSource AncestorType=controls:PluginUserControl}, Path=IntegrationViewItemWithProgressBar, Converter={StaticResource InverseBoolToVisConverter}}">
            <TextBlock.Text>
                <MultiBinding StringFormat="{}{0}/{1}">
                    <Binding RelativeSource="{RelativeSource AncestorType=controls:PluginUserControl}" Path="UnlockedCount" FallbackValue="0" />
                    <Binding RelativeSource="{RelativeSource AncestorType=controls:PluginUserControl}" Path="AchievementCount" FallbackValue="0" />
                </MultiBinding>
            </TextBlock.Text>
        </TextBlock>

        <!-- Progress bar mode (when IntegrationViewItemWithProgressBar=True) -->
        <Grid Visibility="{Binding RelativeSource={RelativeSource AncestorType=controls:PluginUserControl}, Path=IntegrationViewItemWithProgressBar, Converter={StaticResource BooleanToVisibilityConverter}}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="auto" />
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Column="0" VerticalAlignment="Center" Text="-" />

            <ProgressBar Grid.Column="1" Value="{Binding RelativeSource={RelativeSource AncestorType=controls:PluginUserControl}, Path=UnlockedCount, Mode=OneWay, FallbackValue=20}"
                         Maximum="{Binding RelativeSource={RelativeSource AncestorType=controls:PluginUserControl}, Path=AchievementCount, Mode=OneWay}"
                         MinWidth="30"
                         Foreground="{Binding RelativeSource={RelativeSource AncestorType=controls:PluginUserControl}, Path=Foreground}"
                         Height="16" VerticalAlignment="Center" />
        </Grid>
    </Grid>
</controls:PluginUserControl>
